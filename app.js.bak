const { IgApiClient } = require('instagram-private-api');

const ig = new IgApiClient();

(async () => {
    const username = "antonyygab";
    const password = "Six120521!";

    ig.state.generateDevice(username);
    ig.state.proxyUrl = process.env.IG_PROXY;

    await ig.simulate.preLoginFlow();

    const loggedInUser = await ig.account.login(username, password);

    process.nextTick(async () => await ig.simulate.postLoginFlow());

    // Nome de usuário da conta que você deseja seguir
    const usernameToFollow = 'six.rly';

    // Função para buscar o ID da conta com base no nome de usuário
    const userId = await ig.user.getIdByUsername(usernameToFollow);

    if (!userId) {
        console.error(`Não foi possível encontrar a conta com o nome de usuário ${usernameToFollow}`);
        return;
    }

const mensagem = 'Esta é uma mensagem enviada pelo Instagram Private API.';

    // Enviar a mensagem
    await ig.entity.directThread([userId]).broadcastText(mensagem);

})();
